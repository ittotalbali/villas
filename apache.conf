# Enable rewrite and proxy_fcgi
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so

# Allow .htaccess overrides globally for htdocs (simulates shared host)
<Directory "/usr/local/apache2/htdocs">
    AllowOverride All
    Require all granted
</Directory>

# PHP handler: Proxy all .php to FPM
<FilesMatch \.php$>
    SetHandler "proxy:fcgi://php:9000"
</FilesMatch>

# Logging for debug
LogLevel warn rewrite:trace3